--- ../src-base/minecraft/net/minecraft/world/end/DragonFightManager.java
+++ ../src-work/minecraft/net/minecraft/world/end/DragonFightManager.java
@@ -14,6 +14,8 @@
 import java.util.Set;
 import java.util.UUID;
 import javax.annotation.Nullable;
+
+import net.himeki.mcmtfabric.parallelised.ConcurrentCollections;
 import net.minecraft.advancements.CriteriaTriggers;
 import net.minecraft.block.state.BlockWorldState;
 import net.minecraft.block.state.pattern.BlockMatcher;
@@ -54,7 +56,7 @@
     private static final Predicate<EntityPlayerMP> VALID_PLAYER = Predicates.<EntityPlayerMP>and(EntitySelectors.IS_ALIVE, EntitySelectors.withinRange(0.0D, 128.0D, 0.0D, 192.0D));
     private final BossInfoServer bossInfo = (BossInfoServer)(new BossInfoServer(new TextComponentTranslation("entity.EnderDragon.name", new Object[0]), BossInfo.Color.PINK, BossInfo.Overlay.PROGRESS)).setPlayEndBossMusic(true).setCreateFog(true);
     private final WorldServer world;
-    private final List<Integer> gateways = Lists.<Integer>newArrayList();
+    private final List<Integer> gateways = ConcurrentCollections.newArrayList();
     private final BlockPattern portalPattern;
     private int ticksSinceDragonSeen;
     private int aliveCrystals;
@@ -82,6 +84,7 @@
 
             this.dragonKilled = compound.getBoolean("DragonKilled");
             this.previouslyKilled = compound.getBoolean("PreviouslyKilled");
+            this.scanForLegacyFight = !compound.getBoolean("LegacyScanPerformed"); // Forge: fix MC-105080
 
             if (compound.getBoolean("IsRespawning"))
             {
@@ -128,6 +131,7 @@
 
         nbttagcompound.setBoolean("DragonKilled", this.dragonKilled);
         nbttagcompound.setBoolean("PreviouslyKilled", this.previouslyKilled);
+        nbttagcompound.setBoolean("LegacyScanPerformed", !this.scanForLegacyFight); // Forge: fix MC-105080
 
         if (this.exitPortalLocation != null)
         {
@@ -533,6 +537,14 @@
                     return;
                 }
 
+                // CatServer start
+                if (catserver.server.CatServer.getConfig().fixLessCrystalRespawnDragon) {
+                    for (EntityEnderCrystal entityEnderCrystal : list) {
+                        if (list1.contains(entityEnderCrystal)) return;
+                    }
+                }
+                // CatServer end
+
                 list1.addAll(list);
             }
 
@@ -567,7 +579,7 @@
             this.respawnState = DragonSpawnManager.START;
             this.respawnStateTicks = 0;
             this.generatePortal(false);
-            this.crystals = crystalsIn;
+            this.crystals = Collections.synchronizedList(crystalsIn);
         }
     }
 
@@ -582,4 +594,14 @@
             }
         }
     }
+
+    public void addPlayer(EntityPlayerMP player)
+    {
+        this.bossInfo.addPlayer(player);
+    }
+
+    public void removePlayer(EntityPlayerMP player)
+    {
+        this.bossInfo.removePlayer(player);
+    }
 }
